---
import conferences from "../assets/conference.json"
import educations from "../assets/education.json"
import domestics from "../assets/domestic.json"
import awards from "../assets/award.json"

function formatToMonthYear(dateStr) {
const date = new Date(dateStr);
const parts = new Intl.DateTimeFormat('en-US', {
year: 'numeric',
month: 'short',
}).formatToParts(date);

const month = parts.find(p => p.type === 'month')?.value;
const year  = parts.find(p => p.type === 'year')?.value;

return `${month}. ${year}`;
}

function formatToMonthYearJP(dateStr) {
const date = new Date(dateStr);
const parts = new Intl.DateTimeFormat('en-US', {
year: 'numeric',
month: 'numeric',
}).formatToParts(date);

const month = parts.find(p => p.type === 'month')?.value;
const year  = parts.find(p => p.type === 'year')?.value;

return `${year} 年 ${month} 月`;
}
---

<div class="container">
  <div class="simple-header">
    <div class="header-left">
      <div class="name">峯岸 聖太</div>
      <div class="eng-name">Shota Minegishi (@smngs)</div>
      <a href="https://github.com/smngs">
        <span class="badge">
          <span class="fab fa-github fa-sm"></span>
          GitHub
        </span>
      </a>
      <a href="mailto:smngs@smngs.io">
        <span class="badge">
          <span class="fas fa-envelope fa-sm">
          </span>
          Mail
        </span>
      </a>
    </div>
    <div class="header-right">
      <img src="https://github.com/smngs.png" class="icon">
    </div>
  </div>

  <div class="education">
    <h2>Education</h2>
    <ul class="education-list">
      { educations.map(education => (
      <li>
        <div class="line">
          <span class="date">{education.from_year} ~ {education.to_year}</span> 
          <span class="text">{education.topic}</span>
        </div>
      </li>
      ))
      }
    </ul>
  </div>

  <div class="publications">
    <h2>Publications</h2>
    <div class="conference">
      <h3>Conference Proceedings</h3>
      <ol>
        {conferences.map((conference, cIdx) => (
        <li key={cIdx}>
          <span>
            {conference.authors.map((author, i) => (
            <span key={i}>
              {author.me ? (
              <span class="author">{author.name}</span>
              ) : (
              author.name
              )}{i !== conference.authors.length - 1 ? ' and ' : ', '}
            </span>
            ))}
            "<a href={conference.url}>{conference.title}</a>", 
            {conference.book_name},
            {conference.presentation_format != null && (<>{conference.presentation_format}, </>)}
            {conference.place}, 
            {formatToMonthYear(conference.date)}{conference.note != null ? (<span>, ({conference.note}).</span>) : (<span>.</span>)}
          </span>
        </li>
        ))}
      </ol>
    </div>

    <div class="domestic">
      <h3>Presentations (in Japanese)</h3>
      <ol>
        {domestics.map((domestic, cIdx) => (
        <li key={cIdx}>
          <span>
            {domestic.authors.map((author, i) => (
            <span key={i}>
              {author.me ? (
              <span class="author">{author.name}</span>
              ) : (
              author.name
              )}, 
            </span>
            ))}
            "<a href={domestic.url}>{domestic.title}</a>", 
            {domestic.book_name},
            {domestic.presentation_format != null && (<>{domestic.presentation_format}, </>)}
            {domestic.place}, 
            {formatToMonthYearJP(domestic.date)}{domestic.note != null ? (<span>, ({domestic.note}).</span>) : (<span>.</span>)}
          </span>
        </li>
        ))}
      </ol>
    </div>

    <div class="Awards">
      <h3>Awards</h3>
      <ol>
        {awards.map((award) => (
        <li>
          <span>
            <a href={award.url}>{award.name}</a>, 
            {award.lang === "ja"
            ? <span>{formatToMonthYearJP(award.date)}</span>
            : <span>{formatToMonthYear(award.date)}</span>
            }{award.press_url ?(
            award.lang === "ja"
            ? <span>, <a href={award.press_url}>所属機関発表</a>.</span>
            : <span>, <a href={award.press_url}>Press Release</a>.</span>
            ) : <>.</>}
          </span>
        </li>
        ))}
      </ol>
    </div>
  </div>
</div>

<style>
  @import url('https://fonts.googleapis.com/css2?family=M+PLUS+1:wght@100..900&display=swap');

  body {
    font-family: "M PLUS 1", sans-serif;
    font-optical-sizing: auto;
    color: #2f2f2f;
    background-color: #f6f6f6;
    font-weight: 400;
    font-style: normal;
  }

  h2, h3 {
    font-weight: 500;
  }

  h3::before {
    content: "";
    display: inline-block;
    width: 0.3em;
    height: 1em;
    margin-right: 0.4em;
    background-color: #30a3b3;
    border-radius: 0.2em;
    vertical-align: middle;
    position: relative;
    top: -0.1em;
  }

  .simple-header {
    background-color: #30a3b3;
    color: white;
    padding: 3em;
    border-radius: 10px;
    font-size: 24px;
    margin-top: 1em;
    margin-bottom: 1em;

    display: flex;
    flex-wrap: nowrap;
    gap: 1em;
  }

  .simple-header .header-left {
    flex-grow: 1;
    min-width: 0;
  }

  .simple-header .badge {
    display: inline-block;
    background-color: #5e5e5e;
    color: white;
    padding: 10px 8px;
    margin-top: 2em;
    font-size: 12px;
    border-radius: 5px;
    font-weight: bold;
    line-height: 1;
  }

  .simple-header .name {
    font-weight: 500;
  }

  .simple-header .logo {
    width: 16px;
    height: 16px;
  }

  .simple-header .icon {
    width: 8em;
    border-radius: 50%;
    border: 2px solid #ccc;
    background-color: #fff;
    flex-shrink: 0;
  }


  @media screen and (max-width: 768px) {
    .simple-header {
      padding: 2em;
    }

    .simple-header .icon {
      width: 4em;
    }
  }

  .simple-header .name {
    font-size: 36px;
  }

  .simple-header .eng-name {
    font-size: 24px;
  }

  .education {
    margin-top: 1em;
    margin-bottom: 2em;
  }
  .publications {
    margin-top: 1em;
    margin-bottom: 2em;
  }

  .publications ol
    {
    padding-left: 2.5em;
    list-style-type: disc;
  }

  .publications ol > li {
    list-style-position: outside;
  }

  .publications a {
    color: #2f2f2f;
    text-decoration: underline;
  }

  .author {
    font-weight: bold;
    text-decoration: underline;
  }

  .education .education-list {
    padding-left: 1.5em;
    list-style-type: none;
    list-style-position: outside;
    margin: 0;
  }

  .education .education-list li {
    position: relative;
    align-items: flex-start;
    margin-bottom: 1em;
  }

  .education .education-list .line {
    display: flex;
    gap: 1em;
  }

  .education .education-list .line .date {
    flex: 0 0 7em;
    font-weight: bold;
    margin-right: 0.25em;
  }

  .education .education-list .line .text {
  }
</style>
